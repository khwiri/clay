<html>
    <head>
        <title>Clay</title>
        <link rel="stylesheet" href="./css/main.css">
    </head>
    <body>
        <ul class="nav nav-tabs">
            <li class="nav-item quick-connect">Quick Connect</li>
            <li class="nav-item my-connections">My Connections</li>
            <li class="nav-item templates">Templates</li>
            <li class="nav-item settings">Settings</li>
        </ul>
        <div class="content"></div>
        <div class="pages">
            <div class="quick-connect-page">
                <div class="inline-control-group col-2">
                    <div class="control">
                        <label>Host</label>
                        <input class="host" type="text" placeholder="Host Name of IP Address">
                    </div>
                    <div class="control">
                        <label>Port</label>
                        <input class="port" type="text" placeholder="Port (default 22)">
                    </div>
                </div>

                <div class="inline-control-group col-2">
                    <div class="control">
                        <label>Private Key</label>
                        <input class="private-key" type="text" placeholder="Private key file for authentication">
                    </div>
                    <div class="control">
                        <button class="button success private-key-browse" style="margin-top: 20px;">Browse</button>
                    </div>
                </div>

                <div class="submit-row">
                    <button class="button yawn connect">Save</button>
                    <button class="button success connect">Connect</button>
                </div>
            </div>

            <div class="my-connections-page">
                <div class="submit-row">
                    <button class="button success">Create</button>
                </div>
            </div>

            <div class="templates-page">
                <div class="submit-row">
                    <button class="button success create-template">Create</button>
                </div>
            </div>

            <div class="settings-page">
                <div class="inline-control-group col-2">
                    <div class="control">
                        <label>Putty Path</label>
                        <input class="putty-path" type="text" placeholder="">
                    </div>
                    <div class="control">
                        <button class="button success putty-browse" style="margin-top: 20px;">Browse</button>
                    </div>
                </div>

                <div class="submit-row">
                    <button class="button success save">Save</button>
                </div>
            </div>
        </div>

        <div class="dialogs">
            <div class="dialog">
                <div class="content">
                    <div class="header">
                        <i class="fa fa-times close"></i>
                        <h4 class="title"></h4>
                    </div>
                    <div class="body"></div>
                    <div class="footer"></div>
                </div>
            </div>

            <div class="create-template-dialog">
                <div class="title">Create Template</div>
                <div class="content">
                    <div class="control-group">
                        <div class="control">
                            <label>Template Name</label>
                            <input class="template-name" type="text" placeholder="Examples: Prod, QA, Dev">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="control">
                            <label>Background Color</label>
                            <input class="template-background" type="text" placeholder="Example: #ff00ff">
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <button class="button yawn foobar">Cancel</button>
                    <button class="button success foobar">Ok</button>
                </div>
            </div>
        </div>

        <script>
            var $ = require('jQuery');
            const {ipcRenderer} = require('electron');
            const pages = require('./js/pages');
            const Dialog = require('./js/dialog');

            ipcRenderer.send('renderer-ready');
            ipcRenderer.once('startup', function(event, settings) {
                pages.register($('.nav-item.quick-connect'), $('.pages .quick-connect-page'), false); //settings.puttyPath ? true : false);
                pages.register($('.nav-item.my-connections'), $('.pages .my-connections-page'));
                pages.register($('.nav-item.templates'), $('.pages .templates-page'), true);
                pages.register($('.nav-item.settings'), $('.pages .settings-page'), !settings.puttyPath ? true : false);

                if(settings.puttyPath)
                    $('.putty-path').val(settings.puttyPath);
            });

            $('.save').click(function() {
                ipcRenderer.send('save-settings', {
                    puttyPath: $('.putty-path').val()
                });
            });

            $('.putty-browse').click(function() {
                ipcRenderer.send('putty-browse');
                ipcRenderer.once('putty-path', function(event, data) {
                    $('.putty-path').val(data.path);
                });
            });

            $('.create-template').click(() => {
                let dialog = new Dialog();
                dialog.show($('.create-template-dialog').clone(), {
                    close: () => {
                        console.log('on close');
                    }
                });
            });

            $('.connect').click(function() {
                let params = {
                    host: $('.host').val(),
                };

                let port = $('.port').val();
                if(port)
                    params.port = port;

                let ppk = $('.private-key').val();
                if(ppk)
                    params.ppk = ppk;

                ipcRenderer.send('connect', params);
            });

            $('.private-key-browse').click(function() {
                ipcRenderer.send('private-key-browse');
                ipcRenderer.once('private-key-path', function(event, data) {
                    $('.private-key').val(data.path);
                });
            });
        </script>
    </body>
</html>
